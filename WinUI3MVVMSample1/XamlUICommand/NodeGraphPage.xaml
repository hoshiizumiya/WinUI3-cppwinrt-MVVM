<Page
    x:Class="XamlUICommand.NodeGraphPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:XamlUICommand">

    <!-- 顶层仅负责“垂直滚动页面文档” -->
    <ScrollViewer VerticalScrollMode="Enabled"
                    HorizontalScrollMode="Disabled"
                    VerticalScrollBarVisibility="Auto">
        <!-- 居中排版，正文最大宽度，便于阅读 -->
        <StackPanel Spacing="16" Padding="24,20" HorizontalAlignment="Stretch">
            <Grid MaxWidth="860" HorizontalAlignment="Center">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 标题 / 说明 -->
                <TextBlock Grid.Row="0" Text="NodeGraphPanel"
                            Style="{StaticResource TitleTextBlockStyle}" />
                <TextBlock Grid.Row="1" TextWrapping="Wrap" Opacity="0.85">
                    使用基于 Canvas 自定义的图编辑控件。下方为交互性演示，可通过右侧参数调整外观与行为。
                </TextBlock>

                <!-- 可选：提示条 -->
                <InfoBar Grid.Row="2" IsOpen="True" Severity="Informational" Margin="0,8,0,0"
                        Message="演示区支持缩放/平移；双击可在 1x 与 2x 间切换。"/>

                <!-- 演示区卡片（不铺满页面） -->
                <Border Grid.Row="3" Margin="0,16,0,0"
                        Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="12">
                    <Grid ColumnSpacing="16" RowSpacing="12">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="320"/>
                            <!-- 参数面板 -->
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                            <!-- 演示画布 -->
                        </Grid.ColumnDefinitions>

                        <!-- 左侧：参数面板 -->
                        <StackPanel Grid.Column="0" Spacing="10">
                            <TextBlock Text="设置" Style="{StaticResource SubtitleTextBlockStyle}"/>

                            <ToggleSwitch Header="AutoContrast"
                                            IsOn="{Binding ElementName=Graph, Path=AutoContrast, Mode=TwoWay}"/>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock VerticalAlignment="Center" Text="EdgeThickness"/>
                                <NumberBox
                                    Width="96"
                                    SpinButtonPlacementMode="Compact"
                                    SmallChange="0.5"
                                    Minimum="0" Maximum="12"
                                    Value="{Binding ElementName=Graph, Path=EdgeThickness, Mode=TwoWay}"/>
                            </StackPanel>

                            <TextBlock Text="NodeCornerRadius"/>
                            <Slider Minimum="0" Maximum="24" StepFrequency="1"
                                    Value="{Binding ElementName=Graph, Path=NodeCornerRadius, Mode=TwoWay}"/>

                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Button Content="重置视图" Click="OnResetViewClick"/>
                                <Button Content="随机布局" Click="OnRandomizeClick"/>
                            </StackPanel>
                        </StackPanel>

                        <!-- 右侧：演示画布（边框背景 + ScrollView 缩放） -->
                        <Border Grid.Column="2"
                                Background="{ThemeResource LayerFillColorDefaultBrush}"
                                CornerRadius="8"
                                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                Padding="8"
                                Height="420">
                            <!-- 固定演示高度，避免整页被占满 -->
                            <ScrollView x:Name="Zoomer"
                                        HorizontalScrollMode="Enabled"
                                        VerticalScrollMode="Enabled"
                                        ZoomMode="Enabled"
                                        MinZoomFactor="0.25" MaxZoomFactor="8">
                                <!-- 只缩放内容，不缩放外层边框 -->
                                <local:NodeGraphPanel x:Name="Graph"
                                    Width="1600" Height="1000"
                                    Background="Transparent"
                                    EdgeThickness="3"
                                    NodeCornerRadius="12"
                                    AutoContrast="True"
                                    DefaultLabelMetaKey="Name"
                                    DefaultTooltipMetaKey="Desc"
                                    NodeFill="{ThemeResource NodeFillBrush}"
                                    NodeStroke="{ThemeResource NodeStrokeBrush}"
                                    NodeTextBrush="{ThemeResource NodeTextBrush}"
                                    EdgeBrush="{ThemeResource EdgeBrush}"
                                    DoubleTapped="OnGraphDoubleTapped"/>
                            </ScrollView>
                        </Border>
                    </Grid>
                </Border>

                <!-- 可选：用法/API 小节 -->
                <TextBlock Grid.Row="4" Text="用法要点" Margin="0,8,0,0"
                            Style="{StaticResource SubtitleTextBlockStyle}"/>
                <TextBlock Grid.Row="5" TextWrapping="Wrap" Opacity="0.85">
                    1) 演示区用 Card/Border 包裹，视觉独立；2) 只让 ScrollView 的内容缩放，边框不缩放；3) 页面正文在外层 ScrollViewer 内，易于加长文案与多个示例。
                </TextBlock>
            </Grid>
        </StackPanel>
    </ScrollViewer>
</Page>
